{% extends 'utils/base_user_auto.html' %}

{% block content %}


    <!-- BEGIN HOME ADVANCED SEARCH (class="gray" for a gray background) -->
    <div id="advanced-search" class="gray open" style="text-align: left;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12 col-sm-12">
                    <form>

                        <div class="row">
                            <div class="col-md-12 col-sm-12">
                                {{ search_form.location }}
                            </div>
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-9 col-sm-12">
                                        <div class="noleftspace col-md-3 col-sm-4">
                                            {{ search_form.bedrooms }}
                                        </div>
                                        <div class="noleftspace col-md-3 col-sm-4">
                                            {{ search_form.bathrooms }}
                                        </div>
                                        <div class="noleftspace col-md-3 col-sm-4">
                                            {{ search_form.max_price }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <a id='search-btn' class="btn btn-fullcolor pull-right">Search</a>

                    </form>
                </div>

            </div>
        </div>
    </div>
    <!-- END HOME ADVANCED SEARCH -->


    <!-- BEGIN CONTENT WRAPPER -->
    <div class="content">
        <div class="container-fluid">
            <div class="row">

                <!-- BEGIN MAIN CONTENT -->
                <div class="main col-sm-12">

                    <!-- BEGIN PROPERTY LISTING -->
                    <div id="property-listing" class="grid-style1 clearfix">
                        <div class="row" id="search-content">

                        </div>
                    </div>
                    <!-- END PROPERTY LISTING -->


                </div>
                <!-- END MAIN CONTENT -->

            </div>
        </div>
    </div>
    <!-- END CONTENT WRAPPER -->


{% endblock %}

{% block js_script %}
    <script>
        $(document).ready(function () {
            $.ajax({
                method: "GET",
                url: "{% url 'house:search_house_api' %}",
                data: {query: '{{ initial_query }}'}
            }).done(function (data) {
                $("#search-content").empty();
                $.each(data, function (i, item) {
                    var avail_dates = jQuery.parseJSON(item['availability']);

                    var tar_html = "<div class=\"item col-sm-4 col-md-3\"><!-- Set width to 4 columns for grid view mode only -->\n" +
                        "                                <div class=\"image\">\n" +
                        "                                    <a href=\"\">\n" +
                        "                                        <h3>asdndfjnl</h3>\n" +
                        "                                        <span class=\"location\"></span>\n" +
                        "                                    </a>\n" +
                        "                                    <img src=\"" + item['thumbnail'] + "\" alt=\"\"/>\n" +
                        "                                </div>\n" +
                        "                                <div class=\"info\">\n" +
                        "                                    <h3>\n" +
                        "                                        <a href=\"\">" + item['address'] + "</a>\n" +
                        "                                        <small>" + item['location'] + "</small>\n" +
                        "                                    </h3>\n" +
                        "                                    <p>" + item['rent'] + "\n" +
                        "                                        <small>/week</small>\n" +
                        "                                    </p>\n" +
                        "\n" +
                        "                                    <p>Availability: " + avail_dates['lower'] + " to " + avail_dates['upper'] + "</p>\n" +
                        "\n" +
                        "                                    <p>Rental Term: Enquire for details</p>\n" +
                        "\n" +
                        "                                    <ul class=\"amenities\">\n" +
                        "                                        <li><i class=\"icon-bedrooms\"></i>" + item['bedrooms'] + "</li>\n" +
                        "                                        <li><i class=\"icon-bathrooms\"></i> " + item['bathrooms'] + "</li>\n" +
                        "                                        <li><i class=\"icon-garage\"></i> " + item['parking'] + "</li>\n" +
                        "                                    </ul>\n" +
                        "                                </div>\n" +
                        "                            </div>";
                    $("#search-content").append(tar_html)

                })
            });
        });

    </script>

    <script>
        $("#search-btn").click(function () {
            $.ajax({
                method: "GET",
                url: "{% url 'house:search_house_api' %}",
                data: {query: $('#id_location').val()}
            })
                .done(function (data) {
                    $("#search-content").empty();
                    $.each(data, function (i, item) {
                        var avail_dates = jQuery.parseJSON(item['availability']);

                        var tar_html = "<div class=\"item col-sm-4 col-md-3\"><!-- Set width to 4 columns for grid view mode only -->\n" +
                            "                                <div class=\"image\">\n" +
                            "                                    <a href=\"\">\n" +
                            "                                        <h3>asdndfjnl</h3>\n" +
                            "                                        <span class=\"location\"></span>\n" +
                            "                                    </a>\n" +
                            "                                    <img src=\"" + item['thumbnail'] + "\" alt=\"\"/>\n" +
                            "                                </div>\n" +
                            "                                <div class=\"info\">\n" +
                            "                                    <h3>\n" +
                            "                                        <a href=\"\">" + item['address'] + "</a>\n" +
                            "                                        <small>" + item['location'] + "</small>\n" +
                            "                                    </h3>\n" +
                            "                                    <p>" + item['rent'] + "\n" +
                            "                                        <small>/week</small>\n" +
                            "                                    </p>\n" +
                            "\n" +
                            "                                    <p>Availability: " + avail_dates['lower'] + " to " + avail_dates['upper'] + "</p>\n" +
                            "\n" +
                            "                                    <p>Rental Term: Enquire for details</p>\n" +
                            "\n" +
                            "                                    <ul class=\"amenities\">\n" +
                            "                                        <li><i class=\"icon-bedrooms\"></i>" + item['bedrooms'] + "</li>\n" +
                            "                                        <li><i class=\"icon-bathrooms\"></i> " + item['bathrooms'] + "</li>\n" +
                            "                                        <li><i class=\"icon-garage\"></i> " + item['parking'] + "</li>\n" +
                            "                                    </ul>\n" +
                            "                                </div>\n" +
                            "                            </div>";
                        $("#search-content").append(tar_html)
                    })
                });
        });
    </script>

{% endblock %}
